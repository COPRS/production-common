package esa.s1pdgs.cpoc.ingestion.trigger;

import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.junit.Test;


public class TestdataMatchingTest {

	@Test
	public void test() {
		List<String> testDataFileNames = Arrays.asList(
		"EDR_OPER_MPL_CR1_OC_20200331T174549_20200331T180409_0001.EOF", //
		"EDR_OPER_MPL_CR1_OC_20200401T171815_20200401T173635_0001.EOF", //
		"EDR_OPER_MPL_CR1_OC_20200402T165218_20200402T171038_0001.EOF", //
		"EDR_OPER_MPL_CR1_OC_20200403T175512_20200403T181332_0001.EOF", //
		"EDR_OPER_MPL_CR1_OC_20200404T172719_20200404T174539_0001.EOF", //
		"EDR_OPER_MPL_RQ1_OA_20200501T000000_20200525T000000_0019.EOF", //
		"EDR_OPER_SER_SR1_OA_20180427T080001_L20180123160235077001231.EOF", //
		"EDR_OPER_SER_SR1_OA_20200313T075002_L20200203143533370000130.EOF", //
		"EDR_OPER_SER_SR1_OA_20200327T091002_L20200203143533370001015.EOF", //
		"EDR_OPER_SER_SR1_OA_20200327T100002_L20200203144934087001020.EOF", //
		"EDR_OPER_SER_SR1_OC_20200325T180002_L20200319091133113000002.EOF", //
		"EDR_OPER_SER_SR1_OC_20200326T222002_L20200319091133113000003.EOF", //
		"S1A_OPER_AUX_RDB____MPC__20171017T110000_I00000006.TGZ", //
		"S1A_OPER_MPL_FSMPS__PDMC_20200324T092010_V20200324T170000_20200405T190000.EOF", //
		"S1A_OPER_MPL_FSMTI__PDMC_20200324T092113_V20200324T170000_20200405T190000.EOF", //
		"S1A_OPER_MPL_FSSGS__PDMC_20200324T092024_V20200324T170000_20200405T190000.EOF", //
		"S1A_OPER_MPL_SESDBA_20170927T000000_00000006.EOF", //
		"S1A_OPER_MPL__NPIF__20200324T190000_20200405T190000_0005.TGZ", //
		"S1A_OPER_MPL__NPPF__20200316T170000_20200328T190000_0001.EOF", //
		"S1A_OPER_MPL__SSC___20200220T000000_20200319T000000_0001.TGZ", //
		"S1A_OPER_OBS_MIMG___20170927T143123_00000006.TGZ", //
		"S1A_OPER_REP_MP_MP__PDMC_20200303T093232_V20200303T170000_20200319T190000.xml", //
		"S1A_OPER_REP_NPIFCC_20200324T170000_20200405T190000_0001.TGZ", //
		"S1A_OPER_REP_PASS_2_SGS__20200326T150040_V20200326T145206_20200326T145933.EOF", //
		"S1A_OPER_REP_STNACQ_MPS__20200304T192845_V20200304T191631_20200304T192629.EOF", //
		"S1A_OPER_REP_STNACQ_MTI__20200304T161640_V20200304T160257_20200304T161401.EOF", //
		"S1A_OPER_REP__CHF___20200305T080000_20200317T080000_0001.TGZ", //
		"S1A_OPER_SRA_BANSEG_PDMC_20200203T134404_V20200301T000000_20200501T000000.EOF", //
		"S1A_OPER_SRA_BANSEG_PDMC_20200224T154151_V20200225T000000_20200501T000000.EOF", //
		"S1A_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S1A_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S1A_OPER_TLM__PSCAT_20200325T154614_20200325T154614_0001.TGZ", //
		"S1B_OPER_MPL_SPMPS__PDMC_20200302T091444_V20200302T170000_20200314T190000.EOF", //
		"S1B_OPER_MPL_SPMTI__PDMC_20200302T091346_V20200302T170000_20200314T190000.EOF", //
		"S1B_OPER_MPL_SPSGS__PDMC_20200302T091402_V20200302T170000_20200314T190000.EOF", //
		"S1B_OPER_REP_MP_MP__PDMC_20200303T091119_V20200303T170000_20200326T190000.xml", //
		"S1B_OPER_REP_STNACQ_SGS__20200304T191635_V20200304T184113_20200304T185048.EOF", //
		"S1B_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S1B_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S1__OPER_SRA_EDRS_A_PDMC_20200307T030000_V20200307T030000_20200430T203221.EOF", //
		"S2A_OPER_SRA_BANSEG_PDMC_20200305T144837_V20200306T000000_20200501T000000.EOF", //
		"S2A_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S2A_OPER_SRA_GSUNAV_PDMC_20200305T144837_V20200306T000000_20200501T000000.EOF", //
		"S2A_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S2B_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S2B_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S3A_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S3A_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S3B_OPER_SRA_BANSEG_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF", //
		"S3B_OPER_SRA_GSUNAV_PDMC_20200320T150356_V20200501T000000_20200701T000000.EOF");
		
		String patternString = "^(S1[ABCD_]_OPER_REP_MP_MP__PDMC_|S1[ABCD]_OPER_MPL_SP.{4}_PDMC_|S1[ABCD_]_OPER_MPL_FS.{4}_PDMC_|S1[ABCD]_OPER_REP_PASS_[1-9]_.{4}_|S[12]__OPER_SRA_EDRS_[AC]_PDMC_|EDR_OPER_MPL_RQ[1-9]_O[AC]_|EDR_OPER_MPL_[LM]AS_O[AC]_|EDR_OPER_MPL_CR[1-9]_O[AC]_|EDR_OPER_MPL_SS[1-9]_O[AC]_|EDR_OPER_MPL_ER[1-9]_O[AC]_|EDR_OPER_SER_SR[1-9]_O[AC]_|S1[ABCD]_OPER_MPL_ORBOEM_|EDR_OPER_MPL_GOB_P[AC]_|EDR_OPER_MPL_GOB_R[AC]_|S1[ABCD]_OPER_REP__SUP___|S1[ABCD]_OPER_REP_STNACQ_.{4}_|S1[ABCD_]_OPER_REP_STNUNV_.{4}_|S[123][ABCD_]_OPER_SRA_BANSEG_PDMC_|S1[ABCD]_OPER_TLM__REQ_[A-O]_|S1[ABCD]_OPER_REP__SMPR__|S1[ABCD]_OPER_MPL__SSC___|S1[ABCD]_OPER_TLM__PSCAT_|S1[ABCD]_OPER_MPL_OCMSAR_|S1[ABCD]_OPER_REP__MACP__|S1[ABCD]_OPER_REP__MCSF__|S1[ABCD]_OPER_MPL__NPPF__|S1[ABCD]_OPER_MPL__NPIF__|S1[ABCD]_OPER_REP_NPIFCC_|S[123][ABCD_]_OPER_SRA_GSUNAV_PDMC_|S1[ABCD]_OPER_OBS_MIMG___|S1[ABCD]_OPER_AUX_RDB____MPC__|S1[ABCD]_OPER_MPL_SESDB[ABCD]_|S1[ABCD]_OPER_REP__CHF___|S1[AB]_OPER_REP__FCHF__).*\\.(xml|XML|EOF|TGZ)$";
		System.out.println("Pattern: " + patternString + "\n");
		Pattern p = Pattern.compile(patternString);
		
		for (String fn : testDataFileNames) {
			
			if (p.matcher(fn).matches()) {
				System.out.println("Matched: " + fn);
			} else {
				System.out.println("Ignored: " + fn);
			}
		}
		
	}

}
